<!-- src/app/pages/profile/profile.page.html -->
<ion-header>
  <ion-toolbar>
    <ion-title>Profil</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <!-- Section pour les utilisateurs non connectés -->
  <div *ngIf="!user" class="not-connected-container">
    <div class="not-connected-content">
      <ion-icon name="person-circle-outline" class="large-icon"></ion-icon>
      <h2>Vous n'êtes pas connecté</h2>
      <p>Connectez-vous pour accéder à votre profil et personnaliser votre expérience</p>
      <ion-button expand="block" [routerLink]="['/login']" class="login-button">
        <ion-icon name="log-in-outline" slot="start"></ion-icon>
        Se connecter
      </ion-button>
    </div>
  </div>

  <!-- Section pour les utilisateurs connectés -->
  <div *ngIf="user" class="profile-container">
    <div class="profile-header">
      <div class="avatar">
        <ion-icon name="person"></ion-icon>
      </div>
      <h1>{{ user.firstName }} {{ user.lastName }}</h1>
      <p>{{ user.email }}</p>
    </div>

    <div class="profile-section">
      <h2>Informations personnelles</h2>

      <form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
        <ion-item class="custom-item">
          <ion-label position="floating">Prénom</ion-label>
          <ion-input type="text" formControlName="firstName"></ion-input>
          <ion-icon name="person-outline" slot="start"></ion-icon>
        </ion-item>
        <div class="error-message" *ngIf="profileForm.get('firstName')?.invalid && profileForm.get('firstName')?.touched">
          <span *ngIf="profileForm.get('firstName')?.errors?.['required']">Le prénom est requis</span>
        </div>

        <ion-item class="custom-item">
          <ion-label position="floating">Nom</ion-label>
          <ion-input type="text" formControlName="lastName"></ion-input>
          <ion-icon name="person-outline" slot="start"></ion-icon>
        </ion-item>
        <div class="error-message" *ngIf="profileForm.get('lastName')?.invalid && profileForm.get('lastName')?.touched">
          <span *ngIf="profileForm.get('lastName')?.errors?.['required']">Le nom est requis</span>
        </div>

        <ion-button expand="block" type="submit" [disabled]="profileForm.invalid" class="update-button">
          Mettre à jour le profil
        </ion-button>
      </form>
    </div>

    <div class="profile-section">
      <h2>Paramètres du compte</h2>

      <ion-button expand="block" color="danger" fill="outline" class="logout-button" (click)="logout()">
        <ion-icon name="log-out-outline" slot="start"></ion-icon>
        Déconnexion
      </ion-button>
    </div>
  </div>
</ion-content>
