<!-- src/app/pages/auth/register/register.page.html -->
<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/login"></ion-back-button>
    </ion-buttons>
    <ion-title>Inscription</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div class="register-container">
    <h1 class="page-title">Créer un compte</h1>
    <p class="page-subtitle">Rejoignez CesiZen pour améliorer votre bien-être mental</p>

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
      <ion-item class="custom-item">
        <ion-label position="floating">Prénom</ion-label>
        <ion-input type="text" formControlName="prenom"></ion-input>
        <ion-icon name="person-outline" slot="start"></ion-icon>
      </ion-item>
      <div class="error-message" *ngIf="registerForm.get('prenom')?.invalid && registerForm.get('prenom')?.touched">
        <span *ngIf="registerForm.get('prenom')?.errors?.['required']">Le prénom est requis</span>
      </div>

      <ion-item class="custom-item">
        <ion-label position="floating">Nom</ion-label>
        <ion-input type="text" formControlName="nom"></ion-input>
        <ion-icon name="person-outline" slot="start"></ion-icon>
      </ion-item>
      <div class="error-message" *ngIf="registerForm.get('nom')?.invalid && registerForm.get('nom')?.touched">
        <span *ngIf="registerForm.get('nom')?.errors?.['required']">Le nom est requis</span>
      </div>

      <ion-item class="custom-item">
        <ion-label position="floating">Email</ion-label>
        <ion-input type="email" formControlName="email"></ion-input>
        <ion-icon name="mail-outline" slot="start"></ion-icon>
      </ion-item>
      <div class="error-message" *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
        <span *ngIf="registerForm.get('email')?.errors?.['required']">L'email est requis</span>
        <span *ngIf="registerForm.get('email')?.errors?.['email']">Format d'email invalide</span>
      </div>

      <ion-item class="custom-item">
        <ion-label position="floating">Date de naissance</ion-label>
        <ion-datetime formControlName="dateNaissance" displayFormat="DD/MM/YYYY"></ion-datetime>
        <ion-icon name="calendar-outline" slot="start"></ion-icon>
      </ion-item>
      <div class="error-message" *ngIf="registerForm.get('dateNaissance')?.invalid && registerForm.get('dateNaissance')?.touched">
        <span *ngIf="registerForm.get('dateNaissance')?.errors?.['required']">La date de naissance est requise</span>
      </div>

      <ion-item class="custom-item">
        <ion-label position="floating">Mot de passe</ion-label>
        <ion-input [type]="passwordVisible ? 'text' : 'password'" formControlName="motDePasse"></ion-input>
        <ion-icon name="lock-closed-outline" slot="start"></ion-icon>
        <ion-button fill="clear" slot="end" (click)="togglePasswordVisibility()">
          <ion-icon [name]="passwordVisible ? 'eye-off-outline' : 'eye-outline'"></ion-icon>
        </ion-button>
      </ion-item>
      <div class="error-message" *ngIf="registerForm.get('motDePasse')?.invalid && registerForm.get('motDePasse')?.touched">
        <span *ngIf="registerForm.get('motDePasse')?.errors?.['required']">Le mot de passe est requis</span>
        <span *ngIf="registerForm.get('motDePasse')?.errors?.['minlength']">Le mot de passe doit contenir au moins 6 caractères</span>
      </div>

      <ion-item class="custom-item">
        <ion-label position="floating">Confirmer le mot de passe</ion-label>
        <ion-input [type]="passwordVisible ? 'text' : 'password'" formControlName="confirmPassword"></ion-input>
        <ion-icon name="lock-closed-outline" slot="start"></ion-icon>
      </ion-item>
      <div class="error-message" *ngIf="(registerForm.get('confirmPassword')?.touched || registerForm.get('confirmPassword')?.dirty) && registerForm.hasError('notSame')">
        Les mots de passe ne correspondent pas
      </div>

      <ion-button expand="block" type="submit" [disabled]="registerForm.invalid" class="register-button">
        S'inscrire
      </ion-button>
    </form>

    <div class="login-link">
      <p>Vous avez déjà un compte ?</p>
      <ion-button fill="clear" (click)="goToLogin()">Se connecter</ion-button>
    </div>
  </div>
</ion-content>
